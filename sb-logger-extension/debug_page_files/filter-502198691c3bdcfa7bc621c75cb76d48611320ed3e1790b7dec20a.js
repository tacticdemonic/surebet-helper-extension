import n from"jquery";import k from"jquery";import{axios as I}from"utils";import U from"jquery";(function(t){let i='<span data-spin-count=1 class="spinner-border spinner-border-sm" id="spinner"></span>';t.fn.spin=function(){return this.append(i)},t.fn.spinIncr=function(){var e=this.next("#spinner");if(e.length===0)return this.after(i);var o=parseInt(e.attr("data-spin-count"));return e.attr("\
data-spin-count",o+1),e},t.fn.spinDecr=function(){var e=this.next("#spinner");if(e.length>0){var o=parseInt(e.attr("data-spin-count"))-1;o>0?e.attr("data-spin-count",o):e.remove()}return this},t.fn.stopSpin=function(){return this.next("#spinner").remove(),this.find("#spinner").remove(),this},t.stopAllSpins=function(){t(
"#spinner").remove()}})(U);import{Popover as rt,Tooltip as st}from"bootstrap";import w from"dynamic";var $=w.symbols;var J=w.i18n.locale,B=w.i18n.translations[J],W=w.i18n.translations.en,V=(B||W).js;var ct=location.protocol==="https:";function D({url:t,method:i,params:e,body:o,timeout:s=5e4}){var d;let a={Accept:"application/javascript","X-Requested-With":"XMLHttpRequest","X-CSRF-Token":(d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.content,"Cache-Control":"no-cache"},c={url:t,method:i,params:e,data:o,headers:a,timeout:s};function f(u){
let{request:l}=u;if(!(l!=null&&l.readyState)||!(l!=null&&l.status)||location.href.includes("/surebets?format=json"))return;k.stopAllSpins(),k(document).trigger("close.facebox"),window.trackEvent("AjaxError",u.message),console.error(`Request error: ${u.message}`);let m="ajax-error-"+new Date().getTime();k.flashError(V.internal_error,
"ajax_internal_error",m),setTimeout(function(){k("."+m).remove()},6e4)}return I.interceptors.response.use(function(u){var m;return(m=u.headers["content-type"])!=null&&m.match(/(text|application)\/javascript/)&&Q(u.data),u},function(u){return f(u),Promise.reject(u)}),I(c)}function Q(t){let i=document.createElement("scri\
pt"),e=document.querySelector("meta[name=csp-nonce]");i.setAttribute("nonce",e==null?void 0:e.content),i.text=t,document.head.appendChild(i).parentNode.removeChild(i)}function S({value:t}){return t.toString().replace(/,/g,".").replace(/[\s_]/g,"")}function g({field:t,regex:i=/^(-?|\+?)\d*[.,]?\d{0,2}$/}){let e=t.val();i.test(e)||t.val(e.slice(0,-1))}function E({value:t,format:i,allowEmpty:e=!0}){if(!t)return e;let o=S({value:t});switch(i){case"eu":return o>1&&o<1e5;case"us":return o>=100&&o<1e7||o<=-100&&o>-1e7;case"uk":{let r=function(c){return c>0&&c<1e5},s=!!o.match(/^\d+\/\d+$/),a=!!o.split("/").every(r);return s&&a}case"hk":return o>0&&o<1e5;case"my":return o>
0&&o<1e5||o<0&&o>-2e3;case"pr":return o>0&&o<100}}import v from"jquery";var L=(function(){var t=function(i,e){var o=i,s,r=[[1,0],[0,1]];if(e<=0)throw"Max denominator should be greater then 0";for(;r[1][0]*(s=parseInt(i))+r[1][1]<=e;){var a=r[0][0]*s+r[0][1];if(r[0][1]=r[0][0],r[0][0]=a,a=r[1][0]*s+r[1][1],r[1][1]=r[1][0],r[1][0]=a,i==s||(i=1/(i-s),i>2147483647))break}var c=r[0][0],f=r[1][0],
d=o-c/f;s=(e-r[1][1])/r[1][0],r[0][0]=r[0][0]*s+r[0][1],r[1][0]=r[1][0]*s+r[1][1];var u=r[0][0],l=r[1][0],m=o-u/l;return[d,[c,f],m,[u,l]]};return function(i,e){var o=t(parseFloat(i),parseInt(e));return Math.abs(o[0])<Math.abs(o[2])?o[1]:o[3]}})();var y={eu:{toDecimal:function(t){return Number(t)},fromDecimal:function(t){return Number(t).toFixed(3)}},us:{toDecimal:function(t){return t=Number(t),t>=0?(t+100)/100:(100+Math.abs(t))/Math.abs(t)},fromDecimal:function(t){return t=Number(t>=2?100*(t-1):-100/(t-1)).toFixed(0),t>0?"+"+t:t}},uk:{toDecimal:function(t){var i=t.
split("/");return parseFloat(i[0])/parseFloat(i[1])+1},fromDecimal:function(t){let[i,e]=L(t-1,100);return`${Math.round(i)}/${e}`}},hk:{toDecimal:function(t){return(Number(t)+1).toFixed(3)},fromDecimal:function(t){return(Number(t)-1).toFixed(3)}},my:{toDecimal:function(t){return t=Number(t),(t>=0?t+1:1-1/t).toFixed(3)},
fromDecimal:function(t){return t=Number(t),(t<=2?t-1:1/(1-t)).toFixed(3)}},pr:{toDecimal:function(t){return(1/(Number(t.replace("%",""))/100)).toFixed(3)},fromDecimal:function(t){return(1/Number(t)*100).toFixed(2)}}};var C=v("#selector_min_odds").data("odd-format"),N=v("#selector_min_odds,#selector_max_odds");function O(){C&&N.each(function(){if(v(this).val().trim()==="")return;let t=v(this).val().replace(",",".");v(this).val(y[C].toDecimal(t).toString())})}function q(){C&&N.each(function(){if(v(this).val().trim()==="")return;let t=v(
this).val().replace(",",".");v(this).val(y[C].fromDecimal(t).toString())})}var p=document.querySelector('meta[name="session-data"]').dataset,xt=JSON.parse(p.isStaff),Ft=p.domain,wt=p.serviceWorkerPath,kt=parseInt(p.selectedAudioIndex),St=JSON.parse(p.isUserLoggedIn),M=JSON.parse(p.isCompactView),Ct=JSON.parse(p.isNewSurebetsAutoupdateAvailable),Dt=JSON.parse(p.productPageMaximumLimit),yt=JSON.
parse(p.productPageUltimateLimit),Pt=JSON.parse(p.isUserComplexConditionsAvailable),Vt=p.requestMethod;import{Popover as T,Modal as z}from"bootstrap";import X from"dynamic";var G=X.defaultFilterValues.settledPeriod,_,j,h=function(t,i,e){i===""?t.toggleClass("is-invalid",!1):t.toggleClass("is-invalid",e)},P=function(t){let i=t.closest("div > form").find("input:submit");if(i.length>0){let e=n("div.needs-validation > input\
, div.needs-validation > label.with-field");i.prop("disabled",e.hasClass("is-invalid"))}};n(function(){_=n("#filter_current_id"),j=_.data("product"),n("select#selector_min_group_size").on({change:function(){var t=n(this),i=t.val();i==-1&&(t.replaceWith(t.data("extended")),n("input#selector_min_group_size").val("").focus().
on("keyup",function(){h(n(this),n(this).val().trim(),!this.checkValidity()),P(n(this))}).on("input",function(){g({field:n(this),regex:/^\d{0,3}$/})}))}})});n(function(){n("select#selector_settled_period, select#promo_right, select#selector_comb_created_at_period").on({change:function(){var i=n(this),e=i.val();e==-1?(i.
replaceWith(i.data("extended")),n(".selector-settled-group input.form-control").on("keyup",function(){let o=n(this).closest("label"),s=parseInt(n(this).val())||0,r=parseInt(n(this).attr("max"))||G.max,a=!this.checkValidity()||s>r;h(o,n(this).val().trim(),a),P(n(this))}).on("input",function(){g({field:n(this),regex:/^\d{0,4}$/})}).
on("focus",function(){n(this).val()==="0"&&n(this).val("")}).on("focusout",function(){n(this).val().trim()===""&&n(this).val("0")})):i.data("autosubmit")&&i.closest("form").submit()}});var t=n("#filter_current_id option:selected");_.on({change:function(){var i=n(this),e=i.val();if(e==-2)n("#filters").toggle(),t.prop("s\
elected",!0);else if(e==-1)t.prop("selected",!0),z.getOrCreateInstance("#filter-save-as-modal").show();else{let r=function(){i.prop("disabled",!1),i.stopSpin()},o,s=_.data("return-to");e<0?o=`/filters/${_.data("initial")}/revert?to=${-e}&return_to=${s}`:o=`/filters/${e}/choose?product=${j}&return_to=${s}`,i.spin(),i.prop(
"disabled",!0),D({url:o,method:"post"}).finally(r)}}})});n(function(){if(n("div.bookmaker-new-badge-small").length>0){let t=n(".link-bookies-settings-block"),i=n("#link_bookies_settings");t.css({maxWidth:"90%"});let e=new IntersectionObserver(o=>{o.forEach(s=>{s.isIntersecting&&(t.css({width:i[0].offsetWidth+5}),e.disconnect())})},
{threshold:1});e.observe(t[0])}});n(function(){n("input.ff").on("keydown",function(t){(t.charCode||t.keyCode)===27&&(this.value.length>0?this.value="":this.blur())})});n(function(){let t=function(e,o){let s=e.data("min"),r=e.data("max"),a=parseFloat(o),c=e.val().trim();(s||s===0)&&r?h(e,c,!(a>=s&&a<=r)):s||s===0?h(e,c,
!(a>=s)):r?h(e,c,!(a<=r)):h(e,c,!1)},i=function(e){let o=/^((-?|\+?)\d*\.?\d*)$/gm,s=S({value:e.val()});s.length===0?h(e,s,!1):o.test(s)?t(e,s):e.addClass("is-invalid")};n("div.needs-validation > input").on("keyup",function(){let e=n(this);if(/selector_m(in|ax)_odds/.test(e.attr("id"))){let o=e.val().trim(),s=e.data("o\
dd-format");h(e,o,!E({value:o,format:s}))}else if(e.hasClass("custom-validation"))i(e);else{let o=this.checkValidity(),s=e.val().trim();h(e,s,!o);let r=e.data("minimum-limited"),a=e.data("maximum-limited");if(r!=null||a!=null){let f=e.parents('span[data-bs-toggle="popover"]');if(f.length){let l=function(b){e.data("is-f\
eature-popup-visible",b)},x=function(){T.getOrCreateInstance(f).show(),l(!0)},F=function(){T.getOrCreateInstance(f).hide(),l(!1)},d=parseFloat(s),u=d<r||d>a,m=e.data("is-feature-popup-visible");!u||!o?F():m||x(),e.data("hideFeaturePopup",F)}}}P(n(this))}).on("input",function(){["selector_min_m_k","selector_max_m_k","se\
lector_min_odds","selector_max_odds"].includes(n(this).attr("id"))?g({field:n(this),regex:/^(-?|\+?)\d*[./,]?\d{0,3}$/}):g({field:n(this)})}).on("blur",function(){let o=n(this).data("hideFeaturePopup");o&&o()})});n(function(){n(".custom-input-close-icon").on("click",function(){n(this).siblings("input.ff").val("")})});function R({
elementId:t}={}){let i;t?i=n(`#${t} input.all_selector:checkbox`):i=n("input.all_selector:checkbox"),i.each(function(){let e=n(this);if(!t&&e.closest("d-none").length)return;let o=e.data("select");window.syncState(e),n(o).click(()=>{window.syncState(e)})})}n(function(){R(),n(document).on("reveal.facebox",function(){R({
elementId:"facebox"})})});n(function(){q()});n(function(){n(document).on("click","input#filter_new_id_new",function(){n("#filter_new_name").focus()}),n(document).on("change",'.filter-save-as-options-form input[type="radio"]',function(){n("input#filter_new_name").attr("required",n("input#filter_new_id_new").is(":checked"))}),
n(document).on("focus","#filter_new_name",function(){n("input#filter_new_id_new").prop("checked",!0),n("input#filter_new_name").attr("required",!0)}),n(document).on("input","#filter_new_name",function(){let t=n(this).val();t.startsWith(" ")&&n(this).val(t.trim())})});function A(t){return t=t||window.event,(t.which||t.button)===
1}function H(){n("*[id*=_min_], *[id*=_max_]").each((t,i)=>{let e=n(i).val(),o=parseFloat(e);if(isNaN(o))return;let s=n(i).data("minimum-limited"),r=n(i).data("maximum-limited"),a=s!==void 0,c=r!==void 0,f=n(i).attr("id"),d=f.includes("_min_"),u=f.includes("_max_");if(a&&o<s){let l;d?l=s:u&&(c?l=r:l=s),n(i).val(l)}if(c&&
o>r){let l;d?a?l=s:l=r:u&&(l=r),n(i).val(l)}})}n(function(){_.length&&!_[0].classList.contains("disabled")&&_.attr("disabled",!1);var t="#xsports_options_list input:checkbox[id^=xsports_]",i=function(e){n(t).prop("checked",!1),e.trigger("click"),n(".go-filter-sports").trigger("click")};n(document).on("dblclick",t,function(e){
A(e)&&i(n(this))}).on("dblclick",t+" ~ label",function(e){A(e)&&i(n(this).prev("input:checkbox"))})});n(function(){n(document).on("change","#selector_similar_filter",function(){n(this).val()==="required"?(n("input#selector_required_on_top").prop("disabled",!0),n("input#selector_required_on_top").prop("checked",!1)):n("\
input#selector_required_on_top").prop("disabled",!1)})});(function(t){let i=["required","selected","generative","monocombs"];function e(){t(document).trigger("close.facebox"),t("#dq").submit().find(":input").prop("readonly",!0).prop("disabled",!0)}function o(){O();let r=t(".search-narrow").val();t("input#narrow").val(r),
H()}function s(){let r=t("#selected-tournaments-option").prop("checked");t("#selector_is_tournaments_enabled").val(r);let a=Array.from(t("#selected-tournaments-list").find(".selected-tournament-item")).map(u=>u.dataset.id).join(" ");t("#selector_tournaments").val(a);let c=(t("#tournaments-actions").find("input:checked")[0]||
t("#tournaments-actions").find("input")[0]).dataset.action;t("#selector_tournaments_action").val(c);let f=t("#selected-tournaments-categories-option").prop("checked");t("#selector_is_tournaments_categories_enabled").val(f);let d=Array.from(t("#tournaments-categories").find("input:checked")).map(u=>u.value).join(" ");t(
"#selector_tournaments_categories").val(d),e()}t(document).on("reveal.facebox",function(){var r=t("#facebox");M||r.find(".ff").focus()}).on("input","#facebox input.ff:not(.ff-skip)",function(){let r=t(this).val().toLowerCase().replace(new RegExp("[^\\u00BF-\\u1FFF\\u2C00-\\uD7FF\\w]+","g"),""),a=t("label.ff-label, li.f\
f-label");var c=".sbk-menu, .ssp-menu, .pseudo-menu";a.closest(c).removeClass("inact"),r!==""&&a.filter(function(){let f=t(this).data("q");if(f){let u=String(f).split("|");for(var d=0;d<u.length;++d)if(u[d].indexOf(r)!==-1)return!1}return!0}).closest(c).addClass("inact")}).on("click",".go-filter-sports",function(r){r.preventDefault();
var a=t(this).closest(".content").find("input:not(:checked)").map(function(){return t(this).data("ref")}).get(),c=a.join(" ");c===""&&(c="-"),t("#selector_exclude_sports_ids_str").val(c),e()}).on("click",".go-filter-bookies",function(r){r.preventDefault();var a={};t(this).closest(".content").find(".sbk-menu").each(function(){
let l=t(this).find(".bk-menu-trigger").data("bk");l.selected=t(this).find(".bk-selected-check").prop("checked"),a[l.bk]=l});var c=i,f=["bookie_ref","odd_max","odd_min","generative"],d=[];t.each(a,function(l,m){let x=f.map(function(b){return m[b]||""}),F=c.map(function(b){return b==="generative"?0:m[b]?1:0});x.unshift(parseInt(
F.join(""),2)),d.push(x.join(":"))});var u=d.join(";");t("#selector_bookies_settings").val(u),e()}).on("keydown input",".search-narrow",function(r){if(r.keyCode===13&&!t("input:submit#ft")[0].disabled)e();else{let a=t(".search-narrow"),c=a.val();a.closest(".nav-item").toggleClass("with-value",c!==""),a.toggleClass("wit\
h-value",c!==""),a.toggleClass("outline-danger",c[0]==="\\"),a.toggleClass("outline-warning",c[0]==="~")}}).on("submit","#dq",function(){o()}).on("click","#filter-tournaments-submit",s),t(".search-narrow").trigger("input")})(n);

